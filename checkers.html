<html>
<head>
	<style>
		table, td {
		border: 1px solid black;
		width 10px;
		}
	</style>
</head>
<body>
	<table>
	<tr>
	<td><canvas width = "64" height="64" id="Empty" name="11" onclick="turn(11)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="12"onclick="turn(12)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="13"onclick="turn(13)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="14"onclick="turn(14)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="15"onclick="turn(15)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="16"onclick="turn(16)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="17"onclick="turn(17)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="18"onclick="turn(18)"></td>
  </tr>
    <tr>
	<td><canvas width = "64" height="64" id="Empty" name="21"onclick="turn(21)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="22"onclick="turn(22)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="23"onclick="turn(23)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="24"onclick="turn(24)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="25"onclick="turn(25)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="26"onclick="turn(26)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="27"onclick="turn(27)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="28"onclick="turn(28)"></td>
  </tr>
     <tr>
	<td><canvas width = "64" height="64" id="Empty" name="31"onclick="turn(31)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="32"onclick="turn(32)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="33"onclick="turn(33)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="34"onclick="turn(34)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="35"onclick="turn(35)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="36"onclick="turn(36)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="37"onclick="turn(37)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="38"onclick="turn(38)"></td>
  </tr>
  <tr>
	<td><canvas width = "64" height="64" id="Empty" name="41"onclick="turn(41)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="42"onclick="turn(42)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="43"onclick="turn(43)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="44"onclick="turn(44)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="45"onclick="turn(45)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="46"onclick="turn(46)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="47"onclick="turn(47)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="48"onclick="turn(48)"></td>
  </tr>
  <tr>
	<td><canvas width = "64" height="64" id="Empty" name="51"onclick="turn(51)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="52"onclick="turn(52)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="53"onclick="turn(53)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="54"onclick="turn(54)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="55"onclick="turn(55)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="56"onclick="turn(56)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="57"onclick="turn(57)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="58"onclick="turn(58)"></td>
  </tr>
  <tr>
	<td><canvas width = "64" height="64" id="Empty" name="61"onclick="turn(61)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="62"onclick="turn(62)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="63"onclick="turn(63)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="64"onclick="turn(64)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="65"onclick="turn(65)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="66"onclick="turn(66)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="67"onclick="turn(67)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="68"onclick="turn(68)"></td>
  </tr>
  <tr>
	<td><canvas width = "64" height="64" id="Empty" name="71"onclick="turn(71)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="72"onclick="turn(72)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="73"onclick="turn(73)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="74"onclick="turn(74)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="75"onclick="turn(75)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="76"onclick="turn(76)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="77"onclick="turn(77)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="78"onclick="turn(78)"></td>
  </tr>
  <tr>
	<td><canvas width = "64" height="64" id="Empty" name="81"onclick="turn(81)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="82"onclick="turn(82)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="83"onclick="turn(83)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="84"onclick="turn(84)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="85"onclick="turn(85)"></td>
    <td><canvas width = "64" height="64" id="Empty"name="86"onclick="turn(86)"></td>
	<td><canvas width = "64" height="64" id="Empty" name="87"onclick="turn(87)"></td>
	<td><canvas width = "64" height="64" id="Empty"name="88"onclick="turn(88)"></td>
  </tr>
  </table>
  Turn
  <input type="text" id="turn" readonly>
  <input type="button"  value="Red" onclick="redTurn()">
  <input type="button"  value="Black" onclick="blackTurn()">
  <br>
  <input type="button" id="download" value="Download" onclick="download()">
  <input type="file" id="file" value="File"onclick="download()">
  <script>	
  
	// global variables 
	var row,col,i,choice,left;
	var newSquare,currentSquare;
	var currentCanvas,newCanvas,opponentCanvas;
	var context,canvas;
	var redCheckersAlive = 8;
	var blackCheckersAlive = 8;
	var playerTurn = "red";
	
	const beigeSquares = [12,14,16,18,21,23,25,27,32,34,36,38,41,43,45,47,52,54,56,58,61,63,65,67,72,74,76,78,81,83,85,87];
	const saddlebrownSquares=[11,13,15,17,22,24,26,28,31,33,35,37,42,44,46,48,51,53,55,57,62,64,66,68,71,73,75,77,82,84,86,88];
	const inputBox = document.getElementById("square");
	const turnBox = document.getElementById("turn");
	
	// start game 
	turnBox.value=playerTurn;
	restart();
	
	var input = document.getElementById("file");
	
	input.addEventListener("change", function () {
	if (this.files && this.files[0]) {
		var myFile = this.files[0];
		var reader = new FileReader();
		var row,col,index=0;
		reader.addEventListener('load', function (event) {
			var table_contents = event.target.result.split(",");
			for(row=1;row<=8;row++){
				for(col=1;col<=8;col++){
					document.getElementsByName(row.toString().concat(col.toString()))[0].id=table_contents[index];
					index++;
				}
			}
			updateBoard();
    });
    
    reader.readAsText(myFile);
  }   
});
	
	// download text file 
	var filename,text,name;
	document.getElementById("download").addEventListener("click", function(){
		
		text = generate_text();
		name = prompt("What do you want to name the file?");
		filename = name.concat(".txt");
    
    download(filename, text);
	}, false);
	
	function download(filename, text) {
		var element = document.createElement('a');
		element.setAttribute('href', 'data:txt/plain;charset=utf-8,' + encodeURIComponent(text));
		element.setAttribute('download', filename);

		element.style.display = 'none';
		document.body.appendChild(element);

		element.click();

		document.body.removeChild(element);
	}
	
	function generate_text(){
		var row,col;
		var text="";
		
		for (row=1;row<=8;row++){
			for (col=1;col<=8;col++){
				text+=document.getElementsByName(row.toString().concat(col.toString()))[0].id+",";
			
			}
			text+="\n";
		}
		return text;
	}
	
	function redTurn(){
		playerTurn="red";
		turnBox.value="red";
	}
	
	function blackTurn(){
		playerTurn="black";
		turnBox.value="black";
	}
	
	function restart(){
		startGame();
		updateBoard();
	}
	
	function turn(square){
		
		// players take turns 
		
		// red players's turn
		if(playerTurn == "red"){
			redMove(square);
		}
		
		// black player's turn
		else if(playerTurn == "black"){
			blackMove(square);
		}
		
		turnBox.value=playerTurn;
		updateBoard();
		win();
	}
	
	function startGame(){
		
		row=0;
		col=0;
		newSquare=0;
		currentSquare=0;
		currentCanvas=null;
		newCanvas=null;
		opponentCanvas=null;
		context=null;
		canvas=null;
		redCheckersAlive = 8;
		blackCheckersAlive = 8;
		
		// reset all squares to be empty 
		for (row=1;row<=8;row++){
			for(col=1;col<=8;col++){
				canvas = document.getElementsByName(row.toString().concat(col.toString()))[0];
				canvas.id="Empty";
			}
		}
		
		// reset all red checkers
			
		for(col=1;col<=8;col+=2){
			canvas = document.getElementsByName("8".concat(col.toString()))[0];
			canvas.id="Red";
		}
		
		for(col=2;col<=8;col+=2){
			canvas = document.getElementsByName("7".concat(col.toString()))[0];
			canvas.id="Red";
		}
		
		// reset all black checkers
		
		for(col=2;col<=8;col+=2){
			canvas = document.getElementsByName("1".concat(col.toString()))[0];
			canvas.id="Black";
		}
		
		for(col=1;col<=8;col+=2){
			canvas = document.getElementsByName("2".concat(col.toString()))[0];
			canvas.id="Black";
		}
		
  
	}

	function win(){
	
		// case when all black checkers have been captured
		if(blackCheckersAlive==0){
			alert("Red wins");
			restart();
		
		}
		// case when all red checkers have been captured
		if(redCheckersAlive==0){
			alert("Black wins");
			restart();
		
		}
		
		for (col=1;col<=8;col++){
			
			// case when a red checker has reached the end of the board
			canvas=document.getElementsByName("1".concat(col.toString()))[0];
			if(canvas.id == "Red"){
				alert("Red wins");
				restart();
			
			}
			
			// case when a black checker has reached the end of the board
			canvas=document.getElementsByName("8".concat(col.toString()))[0];
			if(canvas.id == "Black"){
				alert("Black wins");
				restart();
			
			}
		}
	}
	
	function is_in(element,array){
		
		for (i=0;i<=array.length-1;i++){
			if (array[i]==element){
				return true 
			}
		
		}
		return false 
	
	}
			
	function updateBoard(){
		
		for(row=1;row<=8;row++){
			for(col=1;col<=8;col++){
				
				canvas = document.getElementsByName(row.toString().concat(col.toString()))[0];
				context = canvas.getContext('2d');
				
				// color the squares 
				if(is_in(parseInt(canvas.getAttribute("name")),beigeSquares)){
					context.fillStyle="beige";
					context.fillRect(0,0,canvas.width,canvas.height);
				}
				
				else if(is_in(parseInt(canvas.getAttribute("name")),saddlebrownSquares)){
					context.fillStyle="saddlebrown";
					context.fillRect(0,0,canvas.width,canvas.height);
				}
				
				// case when square is occupied by red checker
				if(canvas.id=="Red"){
					context.beginPath();
					context.fillStyle="red";
					context.arc(32,32,32,0,2*Math.PI);
					context.fill();
					context.closePath();
					
				}
				// case when square is occupied by black checker
				else if(canvas.id=="Black"){
					context.beginPath();
					context.fillStyle="black";
					context.arc(32,32,32,0,2*Math.PI);
					context.fill();
					context.closePath();
				}
	
			}
		
		}
	}
	
	function redMove(square){
		
		canvas = document.getElementsByName(square)[0];
		
		// square does not have a red checker
		if(canvas.id =="Empty" || canvas.id == "Black"){
			alert("You must select a red checker");
			return 0;
		}
		
		// memorize the current valid square player choose
		currentSquare = parseInt(square);
		
		choice = confirm("Do you want to move?");
		
		
		// player chooses to move
		if(choice){
			
			// chooses player's move direction
			left= confirm("Do you want to move left?");
					
				// player chooses to move left 
				if (left){
					newSquare = currentSquare - 11;
					currentCanvas = document.getElementsByName(currentSquare.toString())[0];
					newCanvas = document.getElementsByName(newSquare.toString())[0];
						
					// case when left square is not occupied
					if(newCanvas.id=="Empty"){
						newCanvas.id="Red";
						currentCanvas.id="Empty";
					}
					else{
						alert("Player cannot move since square to the left is occupied");
						return 0;
					}
				}
					
				// player chooses to move right
				else if(!left){
					newSquare = currentSquare - 9;
					currentCanvas = document.getElementsByName(currentSquare.toString())[0];
					newCanvas = document.getElementsByName(newSquare.toString())[0];
						
					// case when right square is not occupied
					if(newCanvas.id=="Empty"){
						newCanvas.id="Red";
						currentCanvas.id="Empty";
						
					}
					else{
						alert("Player cannot move since square to the right is occupied");
						return 0;
					}
				}
				
			}
			
			// player chooses to attack
			else if(!choice){
			
				// chooses player's attack direction
				left= confirm("Do you want to attack left?");
					
				// player chooses to attack left 
				if (left){
					newSquare = currentSquare - 22;
					opponentSquare = currentSquare - 11;
					
					opponentCanvas = document.getElementsByName(opponentSquare.toString())[0];
					currentCanvas = document.getElementsByName(currentSquare.toString())[0];
					newCanvas = document.getElementsByName(newSquare.toString())[0];
						
					// case when right square is not occupied
					if(newCanvas.id=="Empty" && opponentCanvas.id=="Black"){
						newCanvas.id="Red";
						currentCanvas.id="Empty";
						opponentCanvas.id="Empty";
						blackCheckersAlive--;
					}
					else{
						alert("Player cannot attack left since the checker being attacked is not an enemy or the checker the player is going to occupy is not empty");
						return 0;
					}
				}
					
				// player chooses to attack right
				else if(!left){
					newSquare = currentSquare - 18;
					opponentSquare = currentSquare -9;
					
					opponentCanvas = document.getElementsByName(opponentSquare.toString())[0];
					currentCanvas = document.getElementsByName(currentSquare.toString())[0];
					newCanvas = document.getElementsByName(newSquare.toString())[0];
						
					// case when right square is not occupied
					if(newCanvas.id=="Empty" && opponentCanvas.id=="Black"){
						newCanvas.id="Red";
						currentCanvas.id="Empty";
						opponentCanvas.id="Empty";
						blackCheckersAlive--;
						
					}
					else{
						alert("Player cannot attack right since the checker being attacked is not an enemy or the checker the player is going to occupy is not empty");
						return 0;
					}
				}
			}
			
			// black player moves after red player has made a valid move
			playerTurn = "black";
		}
		
	function blackMove(square){
	
		canvas = document.getElementsByName(square)[0];
		
		
		// square does not have a black checker
		if(canvas.id =="Empty" || canvas.id == "Red"){
			alert("You must select a black checker");
			return 0;
		}
		
		// memorize the current valid square player choose
		currentSquare = parseInt(square);
		
		choice = confirm("Do you want to move?");
		
		
		// player chooses to move
		if(choice){
			
			// chooses player's move direction
			left= confirm("Do you want to move left?");
					
				// player chooses to move left 
				if (left){
					newSquare = currentSquare + 9;
					currentCanvas = document.getElementsByName(currentSquare.toString())[0];
					newCanvas = document.getElementsByName(newSquare.toString())[0];
						
					// case when right square is not occupied
					if(newCanvas.id=="Empty"){
						newCanvas.id="Black";
						currentCanvas.id="Empty";
						
					}
					else{
						alert("Player cannot move since square to the left is occupied");
						return 0;
					}
				}
					
				// player chooses to move right
				else if(!left){
					newSquare = currentSquare + 11;
					currentCanvas = document.getElementsByName(currentSquare.toString())[0];
					newCanvas = document.getElementsByName(newSquare.toString())[0];
						
					// case when right square is not occupied
					if(newCanvas.id=="Empty"){
						newCanvas.id="Black";
						currentCanvas.id="Empty";
						
					}
					else{
						alert("Player cannot move since square to the right is occupied");
						return 0;
					}
				}
				
			}
			
			// player chooses to attack
			else if(!choice){
			
				// chooses player's attack direction
				left= confirm("Do you want to attack left?");
					
				// player chooses to attack left 
				if (left){
					newSquare = currentSquare + 18;
					opponentSquare = currentSquare + 9;
					
					opponentCanvas = document.getElementsByName(opponentSquare.toString())[0];
					currentCanvas = document.getElementsByName(currentSquare.toString())[0];
					newCanvas = document.getElementsByName(newSquare.toString())[0];
						
					// case when right square is not occupied
					if(newCanvas.id=="Empty" && opponentCanvas.id=="Red"){
						newCanvas.id="Black";
						currentCanvas.id="Empty";
						opponentCanvas.id="Empty";
						redCheckersAlive--;
					}
					else{
						alert("Player cannot attack left since the checker being attacked is not an enemy or the checker the player is going to occupy is not empty");
						return 0;
					}
				}
					
				// player chooses to attack right
				else if(!left){
					newSquare = currentSquare + 22;
					opponentSquare = currentSquare + 11;
					
					opponentCanvas = document.getElementsByName(opponentSquare.toString())[0];
					currentCanvas = document.getElementsByName(currentSquare.toString())[0];
					newCanvas = document.getElementsByName(newSquare.toString())[0];
						
					// case when right square is not occupied
					if(newCanvas.id=="Empty" && opponentCanvas.id=="Red"){
						newCanvas.id="Black";
						currentCanvas.id="Empty";
						opponentCanvas.id="Empty";
						redCheckersAlive--;
					}
					else{
						alert("Player cannot attack right since the checker being attacked is not an enemy or the checker the player is going to occupy is not empty");
						return 0;
					}
				}
			}
			
			// red player moves after black player has made a valid move
			playerTurn ="red";
		}
		
  </script>
 </body>
 </html>